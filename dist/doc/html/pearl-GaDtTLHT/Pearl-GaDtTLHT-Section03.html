<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Pearl.GaDtTLHT.Section03</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Pearl-GaDtTLHT-Section03.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">pearl-GaDtTLHT-0.9.5: A Functional Pearl: Generalising and Dualising the third list-homomorphism theorem.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Portability</th><td>portable (ViewPatterns, PatternGuards)</td></tr><tr><th>Stability</th><td>stable</td></tr><tr><th>Maintainer</th><td>Drew Day &lt;drewday@gmail.com&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Pearl.GaDtTLHT.Section03</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Unfolds! Left and Right!
</a></li><li><a href="#g:2">Unfolds are (usually) coinductive...
</a></li><li><a href="#g:3">A definition for unhom
</a></li><li><a href="#g:4">Lemma 3
</a><ul><li><a href="#g:5">Proof: by Example
</a><ul><li><a href="#g:6">Example
</a></li></ul></li></ul></li><li><a href="#g:7">Theorem 02 for Unfolds?
</a></li><li><a href="#g:8"><em>Traces</em> of Unfolding
</a></li><li><a href="#g:9">A crucial property
</a></li><li><a href="#g:10">A Relational Perspective
</a><ul><li><a href="#g:11">Relations: Introduction
</a><ul><li><a href="#g:12">Composition
</a></li><li><a href="#g:13">Converse
</a></li><li><a href="#g:14">Laws
</a></li></ul></li></ul></li><li><a href="#g:15">Theorem 4
</a><ul><li><a href="#g:16">Proof
</a></li></ul></li><li><a href="#g:17">Corollary 5 &lt;- Theorem 4
</a></li><li><a href="#g:18">Proof
</a></li><li><a href="#g:19">Calculating <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>
</a></li><li><a href="#g:20">Figure 1
</a><ul><li><a href="#g:21">Lemma 6
</a></li></ul></li><li><a href="#g:22">Extra Stuff
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc empty">&nbsp;</div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:unfoldr">unfoldr</a> ::  (b -&gt; (a, b)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [a]</li><li class="src short"><a href="#v:unfoldl">unfoldl</a> ::  (b -&gt; (b, a)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [a]</li><li class="src short"><a href="#v:unhom">unhom</a> ::  (t -&gt; (t, t)) -&gt; (t -&gt; a) -&gt; (t -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; (t -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; t -&gt; [a]</li><li class="src short"><a href="#v:t03">t03</a> ::  theorem</li><li class="src short"><a href="#v:t03proof">t03proof</a> ::  theorem proof (by example)</li><li class="src short"><a href="#v:example0">example0</a> :: <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Int.html#t:Int">Int</a> -&gt; [<a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Int.html#t:Int">Int</a>]</li><li class="src short"><a href="#v:question">question</a> ::  a</li><li class="src short"><a href="#v:unfoldrp">unfoldrp</a> ::  (b -&gt; (a, b)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [([a], b)]</li><li class="src short"><a href="#v:unfoldlp">unfoldlp</a> ::  (b -&gt; (b, a)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [(b, [a])]</li><li class="src short"><a href="#v:p05">p05</a> ::  property</li><li class="src short"><a href="#v:p06">p06</a> ::  property</li><li class="src short"><a href="#v:splits">splits</a> ::  [a] -&gt; ([a], [a])</li><li class="src short"><a href="#v:p07">p07</a> ::  property</li><li class="src short"><a href="#v:p08">p08</a> ::  property</li><li class="src short"><a href="#v:t04">t04</a> ::  theorem t02 [on relations]</li><li class="src short"><a href="#v:t04proof">t04proof</a> ::  theorem proof deferred</li><li class="src short"><a href="#v:t05">t05</a> ::  theorem (corollary to t04)</li><li class="src short"><a href="#v:t05proof">t05proof</a> ::  proof (using p07) (using p08) [th04]</li><li class="src short"><a href="#v:p08pick">p08pick</a> ::  pick</li><li class="src short"><a href="#v:t06">t06</a> ::  theorem lemma</li><li class="src short"><a href="#v:t06proof">t06proof</a> ::  proof</li><li class="src short"><a href="#v:-60--124--124-">(&lt;||)</a> ::  (b, t) -&gt; t</li><li class="src short"><a href="#v:-124--124--62-">(||&gt;)</a> ::  (t1, b) -&gt; t</li><li class="src short"><a href="#v:-124--60--124-">(|&lt;|)</a> ::  a</li><li class="src short"><a href="#v:-124--62--124-">(|&gt;|)</a> ::  a</li><li class="src short"><a href="#v:p">p</a> ::  a</li><li class="src short"><a href="#v:f">f</a> ::  a</li><li class="src short"><a href="#v:g">g</a> ::  a</li><li class="src short"><a href="#v:q">q</a> ::  a</li><li class="src short"><a href="#v:k">k</a> ::  a</li><li class="src short"><a href="#v:unfl">unfl</a> ::  a</li><li class="src short"><a href="#v:unfr">unfr</a> :: (<a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> a1, <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> a) =&gt; (a -&gt; (a1, a)) -&gt; (a -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; a -&gt; [[([a1], a)]] -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:-47--92-">(/\)</a> ::  (a -&gt; b) -&gt; (a -&gt; c) -&gt; a -&gt; (b, c)</li></ul></div><div id="interface"><h2 id="g:1">Unfolds! Left and Right!
</h2><div class="doc"><p>The function <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code>, a dual of <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:foldr">foldr</a></code> that generates a list from left
 to right, may be defined as follows: [<code>note01</code>]
</p><pre>
 <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v
              | <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v                  = []
              | (x, v') &lt;- (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) v   = x : <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> '(||&gt;') <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v'
</pre></div><div class="top"><p class="src"><a name="v:unfoldr" class="def">unfoldr</a> ::  (b -&gt; (a, b)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [a]</p></div><div class="doc"><p>Symmetrically, the function unfoldl is defined by:
</p><pre>
 <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>    v
              | <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>    v               = []
              | (v', x) &lt;- (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) v   = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v' <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:-43--43-">++</a></code> [x]
</pre></div><div class="top"><p class="src"><a name="v:unfoldl" class="def">unfoldl</a> ::  (b -&gt; (b, a)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [a]</p></div><h2 id="g:2">Unfolds are (usually) coinductive...
</h2><div class="doc"><p>Typically, unfolds are defined for <em>coinductive, possibly infinite lists</em>. Since we want the unfolded lists to have both a left end
 and a right end, and for another important technical reason to be mentioned later, our <a href="unfolds.html">unfolds</a> in this pearl return inductive, finite
 lists and require separate proofs that all successive applications of <code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code> eventually reach some <code>v</code> for which <code>p v</code> is <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#v:True">True</a></code>.
 Due to space constraints, however, the proof of termination is usually treated informally.
</p></div><h2 id="g:3">A definition for unhom
</h2><div class="doc"><p>Finally, we denote a function <code>k &#8758;&#8758; b &#8594; [ a ]</code> by <code><code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code></code> it it satisfies:
</p><pre>
 <code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code> = <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>
      where 
      <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v | <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v          = []
          | <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code> v          = [<code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code> v]
          | (l,r) &lt;- <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> v = <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> l <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:-43--43-">++</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> r
</pre></div><div class="top"><p class="src"><a name="v:unhom" class="def">unhom</a> ::  (t -&gt; (t, t)) -&gt; (t -&gt; a) -&gt; (t -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; (t -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; t -&gt; [a]</p><div class="doc"><p>We also demand that successive applications of g eventually produce seeds for which either p or q is true, and thus <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> generates finite
 lists.
</p><p>Regrettably, <code>Theorem 1</code> does not dualise to unfolds.
</p></div></div><h2 id="g:4">Lemma 3
</h2><div class="top"><p class="src"><a name="v:t03" class="def">t03</a> ::  theorem</p><div class="doc"><dl><dt><em>Lemma</em>.</dt><dd>
</dd></dl><p>There <em>exist</em> <code>h</code> such that:
</p><pre> h = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code></pre><p>for which there is no corresponding:
</p><pre>
        h = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
          = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
</pre></div></div><h3 id="g:5">Proof: by Example
</h3><div class="top"><p class="src"><a name="v:t03proof" class="def">t03proof</a> ::  theorem proof (by example)</p><div class="doc"><dl><dt><em>Proof</em>:</dt><dd>
 Let <code><code><a href="Pearl-GaDtTLHT-Section03.html#v:example0">example0</a></code> :: Int -&gt; [Int]</code> generate a list of <code>1</code>s of length <code>2^n</code> for a given n.
</dd></dl><p>It can be defined:
</p><pre>
   example0 :: Int -&gt; [Int]
   example0 = unhom
                  (\n -&gt; (n - 1, n - 1))   {-g-}
                  (\0 -&gt; 1)                {-f-}
                  (0 &gt;)                    {-p-}
                  (0 ==)                   {-q-}
</pre><p>But it <em>can not</em> be defined by an <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> or <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code>. An intuitive reason is that there
 is not always an m such that <code>2^n - 1 = 2^m</code>. One may use theories of Gibbons et al. [<code><code><a href="Pearl-GaDtTLHT-References.html#v:r07">r07</a></code></code>]
 for proof.
</p></div></div><h4 id="g:6">Example
</h4><div class="top"><p class="src"><a name="v:example0" class="def">example0</a> :: <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Int.html#t:Int">Int</a> -&gt; [<a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Int.html#t:Int">Int</a>]</p><div class="doc"><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map example0 [1..4]
</code></strong>[[1,1],[1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>map (length . example0) [1..10]
</code></strong>[2,4,8,16,32,64,128,256,512,1024]
</pre></div></div><h2 id="g:7">Theorem 02 for Unfolds?
</h2><div class="top"><p class="src"><a name="v:question" class="def">question</a> ::  a</p><div class="doc"><p>Does theorem 2 have an unfold counterpart? 
</p><p>To establish that:
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code> p' <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code>
</pre><p>Given:
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
     = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
</pre><p>We may simply pick:
</p><pre>
 <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code> g  f   p'  q
              |   |   |
              <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code>   |   |      =     <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Tuple.html#v:fst">fst</a></code> . (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)        -- fixme?
                  p'  |      = <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
                      <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code>      = <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> . <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Tuple.html#v:snd">snd</a></code> . (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)        -- fixme?
</pre><p>The challenge is to construct <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>. To do so, we introduce some concepts dual to those for folds.
</p><p>While <code><a href="Pearl-GaDtTLHT-Section02.html#v:foldrr">foldrr</a></code> and <code><a href="Pearl-GaDtTLHT-Section02.html#v:foldlr">foldlr</a></code> <em>resume</em> a <em>partially computed</em> fold, their duals 
       <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> instead <em>pause</em> during the generation of lists. 
</p><p>During the generation of a list, there are many places where we may pause.
 The following functions <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code>p</code> for <em>pause</em>) return, in a list,
 all intermediate lists and seeds during list generation:
</p><pre>
 <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code>p (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--62--124-">|&gt;|</a></code>) ([], v)
                where (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--62--124-">|&gt;|</a></code>) (xs, v) | <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v                = [(xs, v)]
                                    | (x, v') &lt;- (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) v = (xs, v) : (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--62--124-">|&gt;|</a></code>) (xs <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:-43--43-">++</a></code> [x], v')
</pre><pre>
 <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--60--124-">|&lt;|</a></code>) (v, []) 
                where (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--60--124-">|&lt;|</a></code>) (v, xs) | <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v                 = [(v,xs)]
                                    | (v', x) &lt;- (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) v  = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--60--124-">|&lt;|</a></code>) (v', x:xs) <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:-43--43-">++</a></code> [(v,xs)]
</pre></div></div><div class="top"><p class="src"><a name="v:unfoldrp" class="def">unfoldrp</a> ::  (b -&gt; (a, b)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [([a], b)]</p></div><div class="top"><p class="src"><a name="v:unfoldlp" class="def">unfoldlp</a> ::  (b -&gt; (b, a)) -&gt; (b -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; b -&gt; [(b, [a])]</p></div><h2 id="g:8"><em>Traces</em> of Unfolding
</h2><div class="doc"><p>We may think of <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> as returning the <em>traces</em> of unfolding.
</p><p>For example:
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>  v0
</pre><p>Yields the list:
</p><pre>
   [  ([], v0) , ( [x1], v1 ) , ( [x1,x2] , v2 ), ( [x1,x2,x3], v3 ) ... ]
</pre><p>If:
</p><pre>
    ( x_i+1 , v_i+1 ) = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) v_i
</pre></div><h2 id="g:9">A crucial property
</h2><div class="doc"><p>A crucial property relating <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> is that if:
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
</pre><p>we have both:
</p><pre>
   (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p05">p05</a></code>)       <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> k) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)
   (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p06">p06</a></code>)       <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> (k <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)
</pre><p>where
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> :: [a] -&gt; ( [a], [a] )
</pre><p>Notice how they resemble the <em>converses</em> of <code>(<code><a href="Pearl-GaDtTLHT-Section02.html#v:p03">p03</a></code>)</code> and <code>(<code><a href="Pearl-GaDtTLHT-Section02.html#v:p04">p04</a></code>)</code>:
</p><pre>
   (<code><a href="Pearl-GaDtTLHT-Section02.html#v:p03">p03</a></code>)       <code>h</code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code> = <code><a href="Pearl-GaDtTLHT-Section02.html#v:foldrr">foldrr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> ( <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code>h</code> )
   (<code><a href="Pearl-GaDtTLHT-Section02.html#v:p04">p04</a></code>)       <code>h</code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code> = <code><a href="Pearl-GaDtTLHT-Section02.html#v:foldlr">foldlr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> ( <code>h</code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> )
</pre><pre>
   (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p05">p05</a></code>)       <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> k) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)
   (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p06">p06</a></code>)       <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> (k <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)
</pre><ul><li> the functions next to the composition (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code>) are swapped
</li><li> instead of <code>f . cat</code> we have <code>splits . k</code> on the left hand sides
</li><li> <code>(<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> k)</code> in <code>(5)</code> is on the left-hand side of (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code>), and is lifted to lists by <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code>
   due to the type, etc.
</li></ul></div><div class="top"><p class="src"><a name="v:p05" class="def">p05</a> ::  property</p><div class="doc"><pre>
   (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p05">p05</a></code>)       <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> k) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)
</pre></div></div><div class="top"><p class="src"><a name="v:p06" class="def">p06</a> ::  property</p><div class="doc"><pre>
   (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p06">p06</a></code>)       <code><a href="Pearl-GaDtTLHT-Section03.html#v:splits">splits</a></code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> (k <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)
</pre></div></div><div class="top"><p class="src"><a name="v:splits" class="def">splits</a> ::  [a] -&gt; ([a], [a])</p><div class="doc"><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>splits [1]
</code></strong>[ ([] , [1]) , ( [1], [] ) ]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>splits [1,2]
</code></strong>[ ([], [1,2]), ([1], [2]), ([1,2], []) ]
</pre></div></div><h2 id="g:10">A Relational Perspective
</h2><div class="doc"><p>We could have proceeded from <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p05">p05</a></code>)</code> and <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p06">p06</a></code>)</code> to construct <code>g</code> and thereby prove
 the dual theorem. However, we would like to take a bold approach and ask the readers
 to see paused unfolding <em>as a relation</em>.
</p><p>Functional progammers appear to regard relations as an arcane creation, which is an
 unfortunate misunderstanding.
</p><p>Dijkstra argued that, for <em>program derivation</em>, non-determinism should be the norm
 and determinism a special case [<code><a href="Pearl-GaDtTLHT-References.html#v:r04">r04</a></code>], and this pearl is indeed a case where one
 has to bring up relations to appreciate the nice duality between the theorems for
 folding and unfolding.
</p></div><h3 id="g:11">Relations: Introduction
</h3><div class="doc"><p>For this pearl, we need only a one-paragraph introduction to relations.
</p><p>To say that a function <code>f</code>:
</p><pre>
  f :: a -&gt; b    &quot;is a subset of&quot;    (b <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> a)
                      where:         ( y      , x )  &#8712;   <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code>
  means that:
       y  is a result to which
       f  maps 
       x  (the argument) 
  with the constraint: 
                                     ( y      , x )  &#8712;   <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code>
     and                             ( |   y' , x )  &#8712;   <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code>
                                       |   |
     which normally imply:             y = y'
</pre><p>This constraint is <em>relaxed</em> for relations, allowing <code>x</code> to be mapped
 to multiple <code>ys</code>.
</p></div><h4 id="g:12">Composition
</h4><div class="doc"><p>Composition of relations is defined by:
</p><pre>
   (z, x) &#8712; (R . S) == ( (exists y :: (z,y) &#8712; R) <code><a href="Pearl-GaDtTLHT-Section03.html#v:-47--92-">/\</a></code> ((y,x) &#8712; S) )
</pre></div><h4 id="g:13">Converse
</h4><div class="doc"><p>Given:
</p><pre> R  :: a -&gt; b</pre><p>Its converse:
</p><pre> R&#176; :: b -&gt; a</pre><p>is defined by:
</p><pre>
  (x,y) &#8712; R&#176; == (y,x) &#8712; R
</pre></div><h4 id="g:14">Laws
</h4><div class="doc"><p>We therefore have:
</p><pre>
            (  R&#176;  )&#176;   = R          -- ( &#176; on (R&#176;) is the original R )
  And:         <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>&#176;      = <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>         -- ( &#176; on  <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>  is <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> )
  Also:     (R <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> S)&#176;   = (R&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> S&#176;)   -- ( &#176; distributes covariantly      over (<code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code>) )
  And:      (R  <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> S)&#176;   = S&#176;  <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> R&#176;   -- ( &#176; distributes contravariantly  over (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code>)  )
                                               
</pre><p>In this pearl we view unfolds as the relational converse of folds, which is
 another reason why we restrict ourselves to finite lists -- <em>our unfolds</em> are
 actually converses of folds in disguise, and an <code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code> is the relational converse
 of a list homomoprhism.
</p><p>Let the relation <code>mem</code> relate a list to any of its members:
</p><pre> mem :: [a] -&gt; a</pre><p>and let:
</p><pre>
        unfr (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p = <code>mem</code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p
        unfl (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) p = <code>mem</code> . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) p
</pre></div><div class="doc"><p>While <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> generate the entire trace, <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfl">unfl</a></code> map
 the input seed to one arbitrary intermediate state.
</p><p>That is:
</p><pre>
  <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p
       maps v0 to each of:
                           [ ( []     , v0  ) 
                           , ( [x1]   , v1  ) 
                           , ( [x1,x2], v2  )
                             ...
                           ]
  if:                        ( x_i+1  ,v_i+1) = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) v_i
</pre></div><div class="top"><p class="src"><a name="v:p07" class="def">p07</a> ::  property</p><div class="doc"><p>The equality <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p05">p05</a></code>)</code> can be expressed relationally.
</p><p>If <code>k = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p</code> we have:
</p><pre>
  (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p07">p07</a></code>)     cat&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> ) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p
</pre></div></div><div class="doc"><p>Both sides relate the input seed, say <code>v</code>, to a <em>pair</em> of lists.
 On the left hand side, the list returned by <code>k v</code> is arbitrarily split into <code>(xs,ys)</code>.
</p><p>The equation says that <code>xs <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:-43--43-">++</a></code> ys = <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v</code> if and only if <code>xs</code> can be generated by
    <code><code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p</code> and <code>ys</code> can be generated by <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> starting from where
    <code><code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p</code> left off.
</p></div><div class="top"><p class="src"><a name="v:p08" class="def">p08</a> ::  property</p><div class="doc"><p>For <code>k = <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) p</code>, a symmetric property holds:
</p><pre>
  (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p08">p08</a></code>)     cat&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>  <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfl">unfl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) p
</pre></div></div><div class="doc"><p>Recall that our aim is to construct <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>. It suffices to find a <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> such that:
</p><pre> cat&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code></pre><p>That is:
</p><pre> 
  <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v     = xs <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:-43--43-">++</a></code> ys   iff:
            ||    ||   
            xs    ||   xs and:
                  ys   ys       can be generated 
                                from seeds produced by <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> v.
</pre><p>Notice that by applying the converse operator <code>(_)*</code> to both sides of <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p07">p07</a></code>)</code> and <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p08">p08</a></code>)</code>,
 we get equations that are almost <code>(<code><a href="Pearl-GaDtTLHT-Section02.html#v:p03">p03</a></code>)</code> and <code>(<code><a href="Pearl-GaDtTLHT-Section02.html#v:p04">p04</a></code>)</code> apart from having converses of <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> and
 unfolds in the formulae:
</p><pre>
       k&#176; . cat = (unfr (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) p)&#176; . (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;)
       k&#176; . cat = (unfl (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) p)&#176; . (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>)
</pre></div><h2 id="g:15">Theorem 4
</h2><div class="top"><p class="src"><a name="v:t04" class="def">t04</a> ::  theorem t02 [on relations]</p><div class="doc"><p>The proof of Theorem 2, however, proceeds the same way even if the components
 are not functions! In the realm of relations, part of the proof of Theorem 2
 can be generalized to:
</p><dl><dt><em>Theorem</em>.</dt><dd>
</dd></dl><pre>
 If:
       R . R&#176; . R     =    R                   (R has converse)

Then:
                    R . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code> = Sfwd     . (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> R )
                            = Srev     . (R  <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>)
 { ... }                    = R  . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code> . (R&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> R&#176;) . (R <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> R)
</pre></div></div><h3 id="g:16">Proof
</h3><div class="top"><p class="src"><a name="v:t04proof" class="def">t04proof</a> ::  theorem proof deferred</p><div class="doc"><dl><dt><em>Proof.</em></dt><dd>
</dd></dl><p>The same as that of Theorem 2. We will prove a more general Theorem 7 later.
</p></div></div><h2 id="g:17">Corollary 5 &lt;- Theorem 4
</h2><div class="top"><p class="src"><a name="v:t05" class="def">t05</a> ::  theorem (corollary to t04)</p><div class="doc"><p>The desired dual theorem thus follows:
</p><dl><dt><em>Theorem</em>.</dt><dd>
</dd></dl><pre>
 If:
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>  =  <code><a href="Pearl-GaDtTLHT-Section03.html#v:unhom">unhom</a></code>      <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>  <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code>  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>  <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code>
                    |  |  |  |
                    ?  ?  ?  ?  -- ^ for some g , f , p , and q
 Then:                    |  
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>  =  <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)    <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
      =  <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)    <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
</pre></div></div><h2 id="g:18">Proof
</h2><div class="top"><p class="src"><a name="v:t05proof" class="def">t05proof</a> ::  proof (using p07) (using p08) [th04]</p><div class="doc"><dl><dt><em>Proof.</em></dt><dd>
</dd></dl><p>We have already talked about <code><a href="Pearl-GaDtTLHT-Section03.html#v:f">f</a></code> and <code><a href="Pearl-GaDtTLHT-Section03.html#v:q">q</a></code>, and now we aim to find <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>
 such that:
</p><pre>
        <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = ( <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> ) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>
</pre><p>Using properties <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p07">p07</a></code>)</code> and <code>(<code><a href="Pearl-GaDtTLHT-Section03.html#v:p08">p08</a></code>)</code> as antecedents of Theorem 4 we get:
</p><pre>
 With:
      (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p07">p07</a></code>)    <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = (<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> ) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code>  (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
      (<code><a href="Pearl-GaDtTLHT-Section03.html#v:p08">p08</a></code>)    <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>  <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>) . <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfl">unfl</a></code>  (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)  <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>

We get:
               <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> = (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>  <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> ) . (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;) . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>
</pre></div></div><h2 id="g:19">Calculating <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>
</h2><div class="doc"><p>The expression:
</p><pre> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;) . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code></pre><p>is not easy to simplify. To calculate <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> we often use Lemma 6 to to refine:
</p><pre> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;) . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code></pre><p>to: 
</p><pre>
       ((<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code>) <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>)
   &#8745;   ((<code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:id">id</a></code> <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;) <code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Prelude.html#v:.">.</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfl">unfl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>)
</pre><p>For readers who are not familar with intersection and converses, Figure 1 offers
 some intuition. 
</p><p>Given a seed <code>v</code>, and both:
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfl">unfl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
</pre><p>which non-deterministically pause somewhere and respectively generate <code>(xs,v2)</code> and <code>(v1,ys)</code>.
 The intersection means that they stop when they &quot;meet in the middle&quot;, that is, when
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v1 = xs 
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v2 = ys
</pre><p>The new pair of seeds, a possible result of <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>, is <code>(v1,v2)</code>.
</p></div><div class="top"><p class="src"><a name="v:p08pick" class="def">p08pick</a> ::  pick</p><div class="doc"><p>Thus <code>g</code> can be any functional subset of:
</p><pre>
                                     (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;) . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>
</pre></div></div><h2 id="g:20">Figure 1
</h2><div class="doc"><pre>
                   ------\
                   || ||  \ 
                   || ||   \
                  (xs,v2)   \
                  /^         \ <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfr">unfr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
               <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> /            \ 
                /              \
         (v1,v2)               (v)
                \              /
               <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> \            /
                  \v         / <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfl">unfl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> 
                  (v1,ys)   /
                   || ||   /
                   || ||  /
                   ------/
                        
</pre></div><h3 id="g:21">Lemma 6
</h3><div class="top"><p class="src"><a name="v:t06" class="def">t06</a> ::  theorem lemma</p><div class="doc"><dl><dt><em>Lemma</em>.</dt><dd>
</dd></dl><p>This lemma has a functional formulation that may be more friendly to readers. 
 Writing the list membership predicate <code><code><a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-List.html#v:elem">elem</a></code> :: a -&gt; [a] -&gt; Bool</code> in the Haskell Standard Prelude
 in infix position as <code>(&#8712;)</code>, we have:
</p><p>Assume that:
</p><pre>
   <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>  =  <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldr">unfoldr</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>)    <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
      =  <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldl">unfoldl</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>)    <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code>
</pre><p>A function <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> is a subset of:
</p><pre>
                                     (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176; <code><a href="Pearl-GaDtTLHT-Section02.html#v:-62--60-">&gt;&lt;</a></code> <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code>&#176;) . <code><a href="Pearl-GaDtTLHT-Section02.html#v:cat">cat</a></code>&#176; . k
</pre><p>If, <em>for all</em> <code>v</code>:
</p><pre>
       <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code> v = (  v1,   v2)
 Where:
             (<code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v1,   v2) &#8712; <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldrp">unfoldrp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-124--124--62-">||&gt;</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v
             (  v1, <code><a href="Pearl-GaDtTLHT-Section03.html#v:k">k</a></code> v2) &#8712; <code><a href="Pearl-GaDtTLHT-Section03.html#v:unfoldlp">unfoldlp</a></code> (<code><a href="Pearl-GaDtTLHT-Section03.html#v:-60--124--124-">&lt;||</a></code>) <code><a href="Pearl-GaDtTLHT-Section03.html#v:p">p</a></code> v
</pre><p>From now on we will use Lemma 6 and restrict ourselves to functions when we calculate <code><a href="Pearl-GaDtTLHT-Section03.html#v:g">g</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:t06proof" class="def">t06proof</a> ::  proof</p><div class="doc"><dl><dt><em>Proof</em>:</dt><dd>
</dd></dl><p>Proof omitted!
</p></div></div><h2 id="g:22">Extra Stuff
</h2><div class="top"><p class="src"><a name="v:-60--124--124-" class="def">(&lt;||)</a> ::  (b, t) -&gt; t</p></div><div class="top"><p class="src"><a name="v:-124--124--62-" class="def">(||&gt;)</a> ::  (t1, b) -&gt; t</p></div><div class="top"><p class="src"><a name="v:-124--60--124-" class="def">(|&lt;|)</a> ::  a</p></div><div class="top"><p class="src"><a name="v:-124--62--124-" class="def">(|&gt;|)</a> ::  a</p></div><div class="top"><p class="src"><a name="v:p" class="def">p</a> ::  a</p></div><div class="top"><p class="src"><a name="v:f" class="def">f</a> ::  a</p></div><div class="top"><p class="src"><a name="v:g" class="def">g</a> ::  a</p></div><div class="top"><p class="src"><a name="v:q" class="def">q</a> ::  a</p></div><div class="top"><p class="src"><a name="v:k" class="def">k</a> ::  a</p></div><div class="top"><p class="src"><a name="v:unfl" class="def">unfl</a> ::  a</p></div><div class="top"><p class="src"><a name="v:unfr" class="def">unfr</a> :: (<a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> a1, <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> a) =&gt; (a -&gt; (a1, a)) -&gt; (a -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; a -&gt; [[([a1], a)]] -&gt; <a href="C:\msg\lang\h-7.4.2\lib/../doc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a></p></div><div class="top"><p class="src"><a name="v:-47--92-" class="def">(/\)</a> ::  (a -&gt; b) -&gt; (a -&gt; c) -&gt; a -&gt; (b, c)</p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.11.0</p></div></body></html>